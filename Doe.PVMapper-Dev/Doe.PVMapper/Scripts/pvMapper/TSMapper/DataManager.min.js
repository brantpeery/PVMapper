var pvMapper;(function(n){var r=function(){function n(){}return n.initClientDB=function(){var i=this,t;if(!n.indexedDB){window.alert("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.");return}if(!n.db){try{n.isDBCreating||(n.isDBCreating=!0,t=n.indexedDB.open(n.DB_NAME,n.DBVersion),t.onsuccess=function(t){console.log("Database [PVMapperScores] is open sucessful."),n.db=t.currentTarget.result},t.onerror=function(n){i.clientDBError=!0,console.log("indexedDB open error: "+n.message)},t.onupgradeneeded=function(t){try{var r=t.currentTarget.result.createObjectStore(n.STORE_NAME,{keypath:"title"});n.db=t.currentTarget.result}catch(i){console.log("Creating object store failed, cause: "+i.message)}})}catch(r){console.log("initDB error, cause: "+r.message)}return null}},n.DB_NAME="PVMapperData",n.STORE_NAME="PVMapperScores",n.db=null,n.DBVersion=2,n.indexedDB=window.indexedDB||window.msIndexedDB,n.isDBCreating=!1,n.clientDBError=!1,n}(),t,i;n.ClientDB=r,t=function(){function n(){}return n}(),n.SiteData=t,i=function(){function n(){}return n.prototype.postScore=function(n,t,i,r){$.post("/api/SiteScore",{score:n,rank:t,siteId:i,toolId:r},function(){var n=Ext.getCmp("scoreboard-grid-id");n.store.load(),n.getView().refresh()})},n.prototype.getSite=function(n){return $.get("/api/ProjectSite/"+n)},n.prototype.postSite=function(n,t,i){return $.post("/api/ProjectSite",{name:n,description:t,isActive:!0,polygonGeometry:i})},n.prototype.updateSite=function(n,i,r,u){var f=new t;return f.id=n,f.isActive=!0,i&&(f.name=i),r&&(f.description=r),u&&(f.polygon=u),$.ajax("/api/ProjectSite",{data:f,type:"PUT"})},n.prototype.deleteSite=function(n){return $.ajax("/api/ProjectSite/"+n,{data:{Id:n,type:"DELETE"}})},n}(),n.dataManager=i})(pvMapper||(pvMapper={}))