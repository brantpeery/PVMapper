var INLModules;(function(n){var i=function(){function n(){var n=this,t;this.federalLandsWmsUrl="http://dingo.gapanalysisprogram.com/ArcGIS/services/PADUS/PADUS_owner/MapServer/WMSServer",this.federalLandsRestUrl="http://dingo.gapanalysisprogram.com/ArcGIS/rest/services/PADUS/PADUS_owner/MapServer/",this.landBounds=new OpenLayers.Bounds(-20037508,-20037508,20037508,20037508.34),t=new pvMapper.Module({id:"ProtectedAreasModule",author:"Leng Vang, INL",version:"0.1.ts",activate:function(){n.addMap()},deactivate:function(){n.removeMap()},destroy:null,init:null,scoringTools:[{activate:null,deactivate:null,destroy:null,init:null,title:"Protected Areas",description:"Overlapping protected areas, using PAD-US map data hosted by UI-GAP (gap.uidaho.edu)",category:"Land Use",onScoreAdded:function(){},onSiteChange:function(t,i){n.updateScore(i)},scoreUtilityOptions:{functionName:"linear3pt",functionArgs:new pvMapper.ThreePointUtilityArgs(0,1,1,.6,5,0)},defaultWeight:10}],infoTools:null})}return n.prototype.addMap=function(){this.federalLandsLayer=new OpenLayers.Layer.WMS("Protected Areas",this.federalLandsWmsUrl,{maxExtent:this.landBounds,layers:"0",layer_type:"polygon",transparent:"true",format:"image/gif",exceptions:"application/vnd.ogc.se_inimage",maxResolution:156543.0339,srs:"EPSG:102113"},{isBaseLayer:!1}),this.federalLandsLayer.epsgOverride="EPSG:102113",this.federalLandsLayer.setOpacity(.3),this.federalLandsLayer.setVisibility(!1),pvMapper.map.addLayer(this.federalLandsLayer)},n.prototype.removeMap=function(){pvMapper.map.removeLayer(this.federalLandsLayer,!1)},n.prototype.updateScore=function(n){var t={mapExtent:n.site.geometry.bounds.toBBOX(6,!1),geometryType:"esriGeometryEnvelope",geometry:n.site.geometry.bounds.toBBOX(6,!1),f:"json",layers:"0",tolerance:0,imageDisplay:"1, 1, 96",returnGeometry:!1},i=OpenLayers.Request.GET({url:this.federalLandsRestUrl+"identify",proxy:"/Proxy/proxy.ashx?",params:t,callback:function(t){var c,i,f,e,u;if(t.status===200)if(c=new OpenLayers.Format.JSON,c.extractAttributes=!0,i=c.read(t.responseText),i&&i.results&&i.results.length>0){for(f="",e=null,u=0;u<i.results.length;u++){var o=i.results[u].attributes["Primary Designation Name"],l=i.results[u].attributes["Primary Designation Type"],s=i.results[u].attributes["Owner Name"],h=i.results[u].attributes["Manager Name"],r="";o&&o!="Null"&&isNaN(parseFloat(o))?r+=o:l&&l!="Null"&&(r+=l),h&&h!="Null"?r+=r?": "+h:h:s&&s!="Null"&&(r+=r?": "+s:s),r!=e&&(e!=null&&(f+=", \n"),f+=r),e=r}n.popupMessage=f,n.updateValue(i.results.length)}else n.popupMessage="None",n.updateValue(0);else n.popupMessage="Error "+t.status,n.updateValue(Number.NaN)}})},n}(),r,t,u;n.ProtectedAreasModule=i,r=new n.ProtectedAreasModule,t=function(){function n(){var n=this,t;this.landCoverRestUrl="http://dingo.gapanalysisprogram.com/ArcGIS/rest/services/NAT_LC/1_NVC_class_landuse/MapServer/",this.landBounds=new OpenLayers.Bounds(-20037508,-20037508,20037508,20037508.34),t=new pvMapper.Module({id:"LandCoverModule",author:"Leng Vang, INL",version:"0.1.ts",activate:function(){n.addMap()},deactivate:function(){n.removeMap()},destroy:null,init:null,scoringTools:[{activate:null,deactivate:null,destroy:null,init:null,title:"Land Cover",description:"The type of land cover found in the center of a site, using NLCD map data hosted by UI-GAP (gap.uidaho.edu)",category:"Land Use",onScoreAdded:function(){},onSiteChange:function(t,i){n.updateScore(i)},scoreUtilityOptions:{functionName:"linear",functionArgs:{minValue:0,maxValue:0,tips:{minValue:"The minimum Land Cover allowed.",maxValue:"The maximum Land Cover allowed."}}},defaultWeight:0}],infoTools:null})}return n.prototype.addMap=function(){this.landCoverLayer=new OpenLayers.Layer.ArcGIS93Rest("Land Cover",this.landCoverRestUrl+"export",{layers:"show:0,1,2",format:"gif",srs:"3857",transparent:"true"}),this.landCoverLayer.setOpacity(.3),this.landCoverLayer.epsgOverride="3857",this.landCoverLayer.setVisibility(!1),pvMapper.map.addLayer(this.landCoverLayer)},n.prototype.removeMap=function(){pvMapper.map.removeLayer(this.landCoverLayer,!1)},n.prototype.updateScore=function(n){var t={mapExtent:n.site.geometry.bounds.toBBOX(6,!1),geometryType:"esriGeometryEnvelope",geometry:n.site.geometry.bounds.toBBOX(6,!1),f:"json",layers:"all",tolerance:0,imageDisplay:"1, 1, 96",returnGeometry:!1},i=OpenLayers.Request.GET({url:this.landCoverRestUrl+"identify",proxy:"/Proxy/proxy.ashx?",params:t,callback:function(t){var o,i,r,u,f,e;if(t.status===200)if(o=new OpenLayers.Format.JSON,o.extractAttributes=!0,i=o.read(t.responseText),i&&i.results&&i.results.length>0){for(r="",u=null,f=0;f<i.results.length;f++)e=i.results[f].attributes.NVC_DIV,e!=u&&(u!=null&&(r+=", \n"),r+=e),u=e;n.popupMessage=r,n.updateValue(i.results.length)}else n.popupMessage="No data for this site",n.updateValue(Number.NaN);else n.popupMessage="Error "+t.status,n.updateValue(Number.NaN)}})},n}(),n.LandCoverModule=t,u=new n.LandCoverModule})(INLModules||(INLModules={}))