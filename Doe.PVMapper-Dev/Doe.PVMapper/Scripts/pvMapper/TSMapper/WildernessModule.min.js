var BYUModules;(function(n){var t=function(){function n(){var n=this,t;this.WildernessRestUrl="https://geoserver.byu.edu/arcgis/rest/services/Layers/nat_parks/MapServer/",this.landBounds=new OpenLayers.Bounds(-20037508,-20037508,20037508,20037508.34),t=new pvMapper.Module({id:"WildernessModule",author:"Darian Ramage",version:"0.1.ts",activate:function(){n.addMap()},deactivate:function(){n.removeMap()},destroy:null,init:null,scoringTools:[{activate:null,deactivate:null,destroy:null,init:null,title:"Wilderness",description:"Tells whether the given site is in a wilderness area.  ",category:"Land Use",onScoreAdded:function(){},onSiteChange:function(t,i){n.updateScore(i)},scoreUtilityOptions:{minValue:10,maxValue:0}}],infoTools:null})}return n.prototype.addMap=function(){this.wildernessLayer=OpenLayers.Layer.WMS("Wilderness Areas",this.WildernessRestUrl+"export",{f:"json",layers:"show: 0",transparent:!0},{isBaseLayer:!1}),pvMapper.map.addLayer(this.wildernessLayer)},n.prototype.removeMap=function(){pvMapper.map.removeLayer(this.wildernessLayer,!1)},n.prototype.updateScore=function(n){var t={mapExtent:n.site.geometry.bounds,geometryType:"esriGeometryPolygon",geometry:n.site.geometry,f:"json",layers:"all",tolerance:0,imageDisplay:"1, 1, 96",returnGeometry:!1},i=OpenLayers.Request.GET({url:"https://geoserver.byu.edu/geoserver/wcs?",proxy:"/Proxy/proxy.ashx?",params:t,callback:function(t){var r,i;t.status==200?(r=new OpenLayers.Format.JSON,r.extractAttributes=!0,i=r.read(t.responseText),i&&i.results?i.results.length>0?(console.assert(i.results.length===1,"I expected that the server would only return identify results for the single pixel at the center of a site. Something went wrong."),n.popupMessage=i.results[0].value,n.updateValue(parseFloat(i.results[0].value))):(n.popupMessage="No data for this site",n.updateValue(Number.NaN)):(n.popupMessage="Parse error",n.updateValue(Number.NaN))):(n.popupMessage="Error "+t.status,n.updateValue(Number.NaN))}})},n}(),i;n.WildernessModule=t,i=new n.WildernessModule})(BYUModules||(BYUModules={}))