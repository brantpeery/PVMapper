var INLModules;(function(){function f(){t=new OpenLayers.Layer.WMS("Land Management",u,{layers:"1",format:"gif",srs:"3857",transparent:"true"},{isBaseLayer:!1}),t.setOpacity(.3),t.epsgOverride="3857",t.setVisibility(!1),pvMapper.map.addLayer(t)}function e(){pvMapper.map.removeLayer(t,!1)}function o(t){var i={mapExtent:t.site.geometry.bounds.toBBOX(6,!1),geometryType:"esriGeometryEnvelope",geometry:t.site.geometry.bounds.toBBOX(6,!1),f:"json",layers:"1",tolerance:0,imageDisplay:"1, 1, 96"},u=OpenLayers.Request.GET({url:r+"identify",proxy:"/Proxy/proxy.ashx?",params:i,callback:function(i){var h,r,a,e,u,c,l;if(i.status===200)if(h=new OpenLayers.Format.JSON,h.extractAttributes=!0,r=h.read(i.responseText),r&&r.results)if(r.results.length>0){for(a=0,e=[],u=0;u<r.results.length;u++){var f=r.results[u].value,o=r.results[u].attributes["Feature Type"],s=r.results[u].attributes["SMA Code"];o&&o!="Null"&&f.indexOf(o)<0?f+=" ("+o+")":s&&s!="Null"&&f.indexOf(s)<0&&(f+=" ("+s+")"),e.indexOf(f)<0&&e.push(f)}c=n.sortRatableArray(e),l=n.starRatings[e[0]],t.popupMessage=c,t.updateValue(l)}else t.popupMessage=n.options.noCategoryLabel,t.updateValue(n.starRatings[n.options.noCategoryLabel]);else t.popupMessage="Parse error",t.updateValue(Number.NaN);else t.popupMessage="Error "+i.status,t.updateValue(Number.NaN)}})}var i=function(){function t(){var t=new pvMapper.Module({id:"SolarmapperModule",author:"Scott Brown, INL",version:"0.2.ts",activate:function(){f()},deactivate:function(){e()},destroy:null,init:null,scoringTools:[{activate:null,deactivate:null,destroy:null,init:null,title:"Land Management",description:"Checks solarmapper.anl.gov for intersecting land management polygons",category:"Land Use",onSiteChange:function(n,t){o(t)},getStarRatables:function(){return n.starRatings},scoreUtilityOptions:{functionName:"linear",functionArgs:new pvMapper.MinMaxUtilityArgs(0,5,2.5,"stars")},weight:10}],infoTools:null})}return t}(),s=new i,n=new pvMapper.StarRatingHelper({defaultStarRating:2,noCategoryRating:4,noCategoryLabel:"None"}),r="http://solarmapper.anl.gov/ArcGIS/rest/services/PV_Mapper_SDE/MapServer/",u="http://solarmapper.anl.gov/ArcGIS/services/PV_Mapper_SDE/MapServer/WMSServer",t})(INLModules||(INLModules={}))