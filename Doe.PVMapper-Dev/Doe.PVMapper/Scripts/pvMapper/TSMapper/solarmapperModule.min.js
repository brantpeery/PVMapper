var INLModules;(function(){function u(){n=new OpenLayers.Layer.WMS("Land Management",r,{layers:"1",format:"gif",srs:"3857",transparent:"true"},{isBaseLayer:!1}),n.setOpacity(.3),n.epsgOverride="3857",n.setVisibility(!1),pvMapper.map.addLayer(n)}function f(){pvMapper.map.removeLayer(n,!1)}function e(n){var t={mapExtent:n.site.geometry.bounds.toBBOX(6,!1),geometryType:"esriGeometryEnvelope",geometry:n.site.geometry.bounds.toBBOX(6,!1),f:"json",layers:"1",tolerance:0,imageDisplay:"1, 1, 96"},r=OpenLayers.Request.GET({url:i+"identify",proxy:"/Proxy/proxy.ashx?",params:t,callback:function(t){var o,i,u;if(t.status===200)if(o=new OpenLayers.Format.JSON,o.extractAttributes=!0,i=o.read(t.responseText),i&&i.results)if(i.results.length>0){var s="",h=null,c=0;for(u=0;u<i.results.length;u++){var r=i.results[u].value,f=i.results[u].attributes["Feature Type"],e=i.results[u].attributes["SMA Code"];f&&f!="Null"&&r.indexOf(f)<0?r+=" ("+f+")":e&&e!="Null"&&r.indexOf(e)<0&&(r+=" ("+e+")"),r!=h&&(h!=null&&(s+=", \n"),s+=r,c++),h=r}n.popupMessage=s,n.updateValue(c)}else n.popupMessage="None",n.updateValue(0);else n.popupMessage="Parse error",n.updateValue(Number.NaN);else n.popupMessage="Error "+t.status,n.updateValue(Number.NaN)}})}var t=function(){function n(){var n=new pvMapper.Module({id:"SolarmapperModule",author:"Scott Brown, INL",version:"0.1.ts",activate:function(){u()},deactivate:function(){f()},destroy:null,init:null,scoringTools:[{activate:null,deactivate:null,destroy:null,init:null,title:"Land Management",description:"Checks solarmapper.anl.gov for intersecting land management polygons",category:"Land Use",onScoreAdded:function(){},onSiteChange:function(n,t){e(t)},scoreUtilityOptions:{functionName:"linear3pt",functionArgs:new pvMapper.ThreePointUtilityArgs(0,1,1,.6,5,0)},defaultWeight:10}],infoTools:null})}return n}(),o=new t,i="http://solarmapper.anl.gov/ArcGIS/rest/services/PV_Mapper_SDE/MapServer/",r="http://solarmapper.anl.gov/ArcGIS/services/PV_Mapper_SDE/MapServer/WMSServer",n})(INLModules||(INLModules={}))