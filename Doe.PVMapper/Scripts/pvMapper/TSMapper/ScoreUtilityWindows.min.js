var pvMapper;(function(n){var t=function(){function t(){}return t.basicWindow={_xArgs:{},setup:function(t,i){function c(){Extras.getScript("https://cdnjs.cloudflare.com/ajax/libs/jsxgraph/0.97/jsxgraphcore.js",function(){var l=s(o),g=l[0]==l[1]?1:(l[1]-l[0])/10,a,w,b;l[0]-=g,l[1]+=g*1.5,u=JXG.JSXGraph.initBoard("FunctionBox-body",{boundingbox:[l[0],108,l[1],-8],axis:!0,showCopyright:!1,showNavigation:!0}),h=u.create("functiongraph",function(n){var t=f(n,r._xArgs);return Math.max(0,Math.min(1,t))*100},{strokeWidth:3,strokeColor:"red"});var k=u.getBoundingBox(),d=(k[2]-k[0])/2+k[0],p=f(d,r._xArgs)*100,t=u.create("segment",[[d,0],[d,p]],{name:(k[2]/2).toFixed(1)+" "+r._xArgs.metaInfo.unitSymbol,withLabel:!0,strokeColor:"blue",dash:2,strokeOpacity:.15}),nt=n.getColorForScore(p),i=u.create("segment",[[0,p],[t.point1.X(),p]],{name:"Score: "+p.toFixed(0),withLabel:!0,strokeColor:nt,dash:2,strokeWidth:4,strokeOpacity:1});t.on("drag",function(){u.suspendUpdate();var e=f(t.point1.X(),r._xArgs);e=Math.max(0,Math.min(1,e))*100,t.labelColor("red"),t.setLabelText(t.point1.X().toFixed(1)+" "+r._xArgs.metaInfo.unitSymbol),t.point1.moveTo([t.point1.X(),0]),t.point2.moveTo([t.point1.X(),e]),i.labelColor("red"),i.setLabelText("Score: "+e.toFixed(0)),i.visProp.strokecolor=n.getColorForScore(e),i.point1.moveTo([0,e]),i.point2.moveTo([t.point1.X(),e]),u.unsuspendUpdate()});i.on("drag",function(){u.suspendUpdate();var n=f(t.point1.X(),r._xArgs)*100;i.point1.moveTo([0,n]),i.point2.moveTo([t.point1.X(),n]),u.unsuspendUpdate()});if(a=function(){u.suspendUpdate();var e=f(t.point1.X(),r._xArgs);e=Math.max(0,Math.min(1,e))*100,t.point2.moveTo([t.point1.X(),e]),i.setLabelText("Score: "+e.toFixed(2)),i.point1.moveTo([0,e]),i.point2.moveTo([t.point1.X(),e]),i.visProp.strokecolor=n.getColorForScore(e),u.unsuspendUpdate()},r._xArgs.metaInfo.name=="ThreePointUtilityArgs")r._xArgs.points!=undefined&&r._xArgs.points.length>0&&r._xArgs.points.forEach(function(n){var t=u.create("point",[r._xArgs[n].x,r._xArgs[n].y*100],{name:n,size:3});t.on("drag",function(){r._xArgs[n].x=t.X(),r._xArgs[n].y=t.Y()/100,a()})});else if(r._xArgs.metaInfo.name=="MinMaxUtilityArgs"){w=u.create("point",[r._xArgs.minValue,0],{name:"Min",size:3});w.on("drag",function(){r._xArgs.minValue=w.X(),u.update(),w.moveTo([w.X(),0]),e.setSource(r._xArgs),a()});b=u.create("point",[r._xArgs.maxValue,100],{name:"Max",size:3});b.on("drag",function(){r._xArgs.maxValue=b.X(),u.update(),b.moveTo([b.X(),100]),e.setSource(r._xArgs),a()})}else if(r.xArgs.metaInfo.name=="SinusoidalUtilityArgs"){var v=u.create("point",[r._xArgs.minValue,0],{name:"Min",size:3}),y=u.create("point",[r._xArgs.maxValue,100],{name:"Max",size:3}),c=u.create("point",[r._xArgs.target,50],{name:"target",size:3}),tt=u.create("line",[c,[function(){return c.X()},0]],{dash:2,size:1,strokeOpacity:.15}),it=u.create("line",[c,[0,function(){return c.Y()}]],{dash:2,size:1,strokeOpacity:.15});v.on("drag",function(){var n=v.X();n>c.X()&&(n=c.X()),r._xArgs.minValue=n,u.update(),v.moveTo(n,v.Y()),a()});y.on("drag",function(){var n=y.X();n<c.X()&&(n=c.X()),r._xArgs.maxValue=n,u.update(),y.moveTo(n,y.Y()),a()});c.on("drag",function(){var n=c.X();n<v.X()&&(n=v.X()),n>y.X()&&(n=y.X()),r._xArgs.targetValue=n,u.update(),c.moveTo(n,c.Y()),a()})}})}var o=i.functionArgs,f=n.UtilityFunctions[i.functionName].fn,s=n.UtilityFunctions[i.functionName].xBounds,r=this,u,h,e;r._xArgs=Ext.Object.merge({},o),t.removeAll(),e=Ext.create("Ext.grid.property.Grid",{source:r._xArgs,tipValue:null,viewConfig:{deferEmptyText:!1,emptyText:"<center><i>no editable fields<\/i><\/center>"},listeners:{edit:function(){u.update()},propertychange:function(){u.update()},itemmouseenter:function(n,t){this.tipValue=this.source.metaInfo!=undefined?this.source.metaInfo[t.internalId+"Tip"]:"Property "+t.internalId,this.tip.update(this.tipValue)},itemmouseleave:function(){this.tipValue=null},render:function(n){var t=this;n.tip=Ext.create("Ext.tip.ToolTip",{target:n.el,delegate:n.cellSelector,trackMouse:!0,renterTo:Ext.getBody(),listeners:{beforeshow:function(n){n.update(t.tipValue)}}})}}}),t.add(e),t.add({xtype:"panel",layout:{align:"center",pack:"center",type:"vbox"},items:{id:"FunctionBox",xtype:"panel",layout:"fit",border:!0,width:200,height:225,padding:5},listeners:{afterrender:function(){c()}}})},okhandler:function(n,t){Ext.apply(t,this._xArgs)}},t}();n.ScoreUtilityWindows=t})(pvMapper||(pvMapper={}))