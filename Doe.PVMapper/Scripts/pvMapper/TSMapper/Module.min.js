var pvMapper;(function(n){var t=function(){function t(){this.id="",this.author="",this.version="",this.settings=this.self=this,this.id=typeof this.self.settings.id=="string"?this.self.settings.id:"",this.author=typeof this.self.settings.author=="string"?this.self.settings.author:"",this.scoringTools=[];var t=new n.ScoringTool;t.calculateCallback=this.calculateSiteArea,t.updateCallback=this.updateSetbackFeature,this.scoringTools.push(t)}return t.prototype.init=function(){},t.prototype.destroy=function(){},t.prototype.activate=function(){},t.prototype.deactivate=function(){},t.prototype.addScoringTool=function(n){this.scoringTools.push(n)},t.prototype.removeScoringTool=function(n){var t=this.scoringTools.indexOf(n,0);t>=0&&this.scoringTools.splice(t,1)},t.prototype.calculateArea=function(n){var t=new OpenLayers.Projection("EPSG:900913"),i=n.getGeodesicArea(t),r=i/1e6;return Math.round(r*100)/100},t.prototype.calculateSiteArea=function(n){return this.calculateArea(n.feature.geometry)},t.prototype.updateSetbackFeature=function(t,i){var s=new jsts.io.WKTReader,r=new jsts.io.OpenLayersParser,e=r.read(t.feature.geometry),o=e.buffer(-1*i),u=r.write(o),f;return this.setbackLayer||(this.setbackLayer=new OpenLayers.Layer.Vector("Site Setback"),n.map.addLayer(this.setbackLayer)),t.offsetFeature?(this.setbackLayer.removeFeatures(t.offsetFeature),t.offsetFeature.geometry=u):(f={fillColor:"blue",fillOpacity:0,strokeWidth:3,strokeColor:"purple"},t.offsetFeature=new OpenLayers.Feature.Vector(u,{parentFID:t.feature.fid},f)),this.setbackLayer.addFeatures(t.offsetFeature),0},t}();n.Module=t,n.map=new OpenLayers.Map})(pvMapper||(pvMapper={}))