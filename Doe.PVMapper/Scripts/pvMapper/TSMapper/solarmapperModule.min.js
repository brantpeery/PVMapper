var INLModules;(function(){function u(){n=new OpenLayers.Layer.ArcGIS93Rest("Land Management",t+"export",{layers:"72",format:"gif",srs:"3857",transparent:"true"},{maxExtent:[-1385e4,3675e3,-1135e4,5165e3]}),n.setOpacity(.3),n.epsgOverride="3857",n.setVisibility(!1),pvMapper.map.addLayer(n)}function f(){pvMapper.map.removeLayer(n,!1)}function i(i){if(!n.maxExtent.intersectsBounds(i.site.geometry.bounds)){i.popupMessage="No data for this site",i.updateValue(Number.NaN);return}var r={mapExtent:i.site.geometry.bounds.toBBOX(6,!1),geometryType:"esriGeometryEnvelope",geometry:i.site.geometry.bounds.toBBOX(6,!1),f:"json",layers:"72",tolerance:0,imageDisplay:"1, 1, 96"},u=OpenLayers.Request.GET({url:t+"identify",proxy:"/Proxy/proxy.ashx?",params:r,callback:function(n){var o,t,u,f,r,e;if(n.status===200)if(o=new OpenLayers.Format.JSON,o.extractAttributes=!0,t=o.read(n.responseText),t&&t.results)if(t.results.length>0){for(u="",f=null,r=0;r<t.results.length;r++)e=t.results[r].layerName+": "+t.results[r].value,e!=f&&(f!=null&&(u+=", \n"),u+=e),f=e;i.popupMessage=u,i.updateValue(t.results.length)}else i.popupMessage="None",i.updateValue(0);else i.popupMessage="Parse error",i.updateValue(Number.NaN);else i.popupMessage="Connection error "+n.status,i.updateValue(Number.NaN)}})}var r=function(){function n(){var n=new pvMapper.Module({id:"SolarmapperModule",author:"Scott Brown, INL",version:"0.1.ts",activate:function(){u()},deactivate:function(){f()},destroy:null,init:null,scoringTools:[{activate:null,deactivate:null,destroy:null,init:null,title:"Land Management",description:"Checks solarmapper.anl.gov for intersecting land management polygons",onScoreAdded:function(){},onSiteChange:function(n,t){i(t)},updateScoreCallback:function(n){i(n)}}],infoTools:null})}return n}(),e=new r,t="http://solarmapper.anl.gov/ArcGIS/rest/services/Solar_Mapper_SDE/MapServer/",n})(INLModules||(INLModules={}))