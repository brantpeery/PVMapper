var BYUModules;(function(){function u(){n=new OpenLayers.Layer.ArcGIS93Rest("World Topography",i+"export",{layers:"visible",format:"gif",srs:"3857"},{isBaseLayer:!0}),n.epsgOverride="3857",n.setVisibility(!1),pvMapper.map.addLayer(n)}function f(){pvMapper.map.removeLayer(n,!1)}function t(n,t,r){var u={mapExtent:n.site.geometry.bounds.toBBOX(6,!1),geometryType:"esriGeometryEnvelope",geometry:n.site.geometry.bounds.toBBOX(6,!1),f:"json",layers:t,tolerance:0,imageDisplay:"1, 1, 96",returnGeometry:!1},f=OpenLayers.Request.GET({url:i+"identify",proxy:"/Proxy/proxy.ashx?",params:u,callback:function(t){var u,i;t.status===200?(u=new OpenLayers.Format.JSON,u.extractAttributes=!0,i=u.read(t.responseText),i&&i.results?i.results.length>0?(console&&console.assert(i.results.length===1,"I expected that the server would only return identify results for the single pixel at the center of a site; boy, was I ever wrong."),n.popupMessage=i.results[0].value+" "+r,n.updateValue(parseFloat(i.results[0].value))):(n.popupMessage="No data for this site",n.updateValue(Number.NaN)):(n.popupMessage="Parse error",n.updateValue(Number.NaN))):(n.popupMessage="Error "+t.status,n.updateValue(Number.NaN))}})}var r=function(){function n(){var n=new pvMapper.Module({id:"DemModule",author:"Darian Ramage, BYU",version:"0.1.ts",activate:function(){u()},deactivate:function(){f()},destroy:null,init:null,scoringTools:[{activate:null,deactivate:null,destroy:null,init:null,title:"Slope",description:"Calculates the average slope of the site",category:"Geography",onScoreAdded:function(){},onSiteChange:function(n,i){t(i,"any:3","degrees")},scoreUtilityOptions:{functionName:"linear",functionArgs:new pvMapper.MinMaxUtilityArgs({minValue:0,maxValue:10})}},{activate:null,deactivate:null,destroy:null,init:null,title:"Aspect",description:"Calculates the average aspect of the site",category:"Geography",onScoreAdded:function(){},onSiteChange:function(n,i){t(i,"any:4","degrees")},scoreUtilityOptions:{functionName:"linear3pt",functionArgs:{p0:{x:0,y:.5},p1:{x:180,y:1},p2:{x:360,y:.5}}}},{activate:null,deactivate:null,destroy:null,init:null,title:"Elevation",description:"Calculates the averate elevation of the site",category:"Geography",onScoreAdded:function(){},onSiteChange:function(n,i){t(i,"any:1","m")},scoreUtilityOptions:{functionName:"linear3pt",functionArgs:{p0:{x:0,y:.5},p1:{x:1e3,y:.9},p2:{x:6e3,y:1}}}}],infoTools:null})}return n}(),e=new r,i="http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/",n})(BYUModules||(BYUModules={}))