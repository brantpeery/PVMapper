var INLModules;(function(){function e(){}function o(){r!==null&&(pvMapper.map.removeLayer(r,!1),r=null)}function n(r,u){var e=u*1609.34,o=OpenLayers.Request.GET({url:f,params:{f:"json",outFields:"*",geometryType:"esriGeometryEnvelope",geometry:new OpenLayers.Bounds(r.site.geometry.bounds.left-e-1e3,r.site.geometry.bounds.bottom-e-1e3,r.site.geometry.bounds.right+e+1e3,r.site.geometry.bounds.top+e+1e3).toBBOX(0,!1)},proxy:"/Proxy/proxy.ashx?",callback:function(f){var v,s,l,h,o,p,w;if(f.status===200){var y=null,a=e,c=OpenLayers.Format.EsriGeoJSON.prototype.read(f.responseText);if(c)for(o=0;o<c.length;o++)v=r.site.geometry.distanceTo(c[o].geometry,{edge:!1}),v<a&&(a=v,y=c[o]);if(y!==null){for(s=a*.000621371,t[r.site.id]=s,l=0,h=5e3,o=i.length-1;o--;o>=0)if(s>=i[o].mi){l=i[o].percentOk,h=i[o].mi;break}p=h<1?h.toFixed(2):h<10?h.toFixed(1):h.toFixed(0),w=s<1?s.toFixed(2):s<10?s.toFixed(1):s.toFixed(0),r.popupMessage=l.toFixed(1)+"% of respondents reported they would accept a site built "+p+" mi or more from agriculture. (The nearest agriculture is "+w+" mi away.)",r.updateValue(l)}else u<5e3?n(r,u*10):(r.popupMessage="100% of respondents reported they would accept a site built over 5000 mi from agriculture. (There was no agriculture found within 5000 mi.)",r.updateValue(100))}else r.popupMessage="Error "+f.status+" "+f.statusText,r.updateValue(Number.NaN)}})}var i=[{mi:0,percentOk:11.51385928},{mi:.000189394,percentOk:11.72707889},{mi:.000378788,percentOk:11.94029851},{mi:.001136364,percentOk:12.15351812},{mi:.001893939,percentOk:12.57995736},{mi:.003787879,percentOk:12.79317697},{mi:.005681818,percentOk:13.43283582},{mi:.009469697,percentOk:13.85927505},{mi:.018939394,percentOk:15.99147122},{mi:.028409091,percentOk:16.20469083},{mi:.037878788,percentOk:16.63113006},{mi:.056818182,percentOk:17.27078891},{mi:.09469697,percentOk:18.12366738},{mi:.142045455,percentOk:18.33688699},{mi:.170454546,percentOk:18.55010661},{mi:.189393939,percentOk:19.18976546},{mi:.227272727,percentOk:19.61620469},{mi:.25,percentOk:21.53518124},{mi:.284090909,percentOk:21.74840085},{mi:.5,percentOk:25.58635394},{mi:.568181818,percentOk:25.79957356},{mi:1,percentOk:42.85714286},{mi:2,percentOk:47.76119403},{mi:3,percentOk:50.74626866},{mi:4,percentOk:50.95948827},{mi:5,percentOk:66.73773987},{mi:6,percentOk:67.1641791},{mi:7,percentOk:67.59061834},{mi:8,percentOk:70.14925373},{mi:10,percentOk:78.03837953},{mi:12,percentOk:78.25159915},{mi:14,percentOk:78.46481876},{mi:14.2,percentOk:78.67803838},{mi:15,percentOk:81.23667377},{mi:20,percentOk:86.35394456},{mi:25,percentOk:88.91257996},{mi:30,percentOk:92.53731343},{mi:35,percentOk:92.75053305},{mi:40,percentOk:93.81663113},{mi:50,percentOk:97.01492537},{mi:100,percentOk:99.14712154},{mi:129,percentOk:99.36034115},{mi:200,percentOk:99.78678038},{mi:5e3,percentOk:100}],t={},u=function(){function i(){var i=new pvMapper.Module({id:"AgricultureSocialModule",author:"Scott Brown, INL",version:"0.1.ts",iconURL:"http://www.iconshock.com/img_jpg/MODERN/general/jpg/16/home_icon.jpg",activate:function(){e()},deactivate:function(){o()},destroy:null,init:null,scoringTools:[{activate:null,deactivate:null,destroy:null,init:null,title:"Agriculture Proximity",description:"Percentage of survey respondents who reported this distance from agriculture as acceptable",category:"Social Acceptance",onSiteChange:function(i,r){t[r.site.id]>500?n(r,5e3):t[r.site.id]>50?n(r,500):t[r.site.id]>5?n(r,50):t[r.site.id]>.5?n(r,5):n(r,.5)},scoreUtilityOptions:{functionName:"linear3pt",functionArgs:new pvMapper.ThreePointUtilityArgs(0,.4,30,.8,100,1,"% in favor")},weight:10}],infoTools:null})}return i}(),s=new u,f="http://gis-ext.inl.gov/ArcGIS/rest/services/Ag_Lands/MapServer/0/query",r})(INLModules||(INLModules={}))