var pvMapper;(function(n){var t=function(){function t(t){var i=this;this.scores=[],this.updateScore=t.updateScoreCallback,this.active=!0,this.scoreAddedEvent=new n.Event,this.scoreChangeEvent=new n.Event,this.updatingScoresEvent=new n.Event,this.self=this,this.name=typeof t.title=="string"?t.title:"Unnamed Tool",this.description=typeof t.description=="string"?t.description:"Unnamed Tool",this.category=typeof t.category=="string"?t.category:"Other",this.weight=1,$.isFunction(t.onSiteChange)&&(this.onSiteChangeHandler=t.onSiteChange),this.valueChangeHandler=function(n){n.score.setUtility(i.getUtilityScore(n.newValue)),i.scoreChangeEvent.fire(self,n)},$.isFunction(t.onScoreAdded)&&this.scoreAddedEvent.addHandler(t.onScoreAdded),n.siteManager.siteAdded.addHandler(function(n){console.log("Siteadded event detected in scoreline"+name),i.addScore(n)}),n.siteManager.siteRemoved.addHandler(this.onSiteRemove),t.scoreUtilityOptions==undefined&&(t.scoreUtilityOptions={maxValue:1,minValue:0,target:.5,slope:50,functionName:"random"}),this.scoreUtility=new n.ScoreUtility(t.scoreUtilityOptions),this.weight=typeof t.defaultWeight=="undefined"?10:t.defaultWeight,this.loadAllSites()}return t.prototype.getUtilityScore=function(n){return this.scoreUtility.run(n)},t.prototype.getWeight=function(){return this.weight},t.prototype.getWeightedUtilityScore=function(){return 0},t.prototype.addScore=function(t){var i=new n.Score(t);i.siteChangeEvent.addHandler(this.onSiteChangeHandler),i.valueChangeEvent.addHandler(this.valueChangeHandler),this.scores.push(i);try{this.updateScore(i)}catch(r){console.log(r)}return i},t.prototype.removeScore=function(){},t.prototype.updateScores=function(){},t.prototype.loadAllSites=function(){var t=n.siteManager.getSites();$.each(t,function(n,t){this.addScore(t)})},t.prototype.onSiteRemove=function(t){console.log("Attempting to remove a site/score from the scoreline"),t.data instanceof n.Site&&this.self.removeScore(t.data)},t}();n.ScoreLine=t})(pvMapper||(pvMapper={}))